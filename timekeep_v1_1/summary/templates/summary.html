{% extends 'base.html' %}

{% load format_min %}

{% block title %}Summary | {% endblock %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col">
      <h2>Your time {% if num_days is 0 %}today{% else %}{{ date_user|date:"Y-m-d" }}{% endif %}</h2>

      {% if date_entries %}
        <table class="table">
          <thead>
          <tr>
            <th scope="row">Project</th>
            <th scope="row">Time</th>
          </tr>
          </thead>
          <tbody>
          {% for entry in date_entries %}
                    <tr>
            <td>{{ entry.project.title }}</td>
            <td>{{ entry.minutes|format_minutes }}</td>
          </tr>
          {% endfor %}
          </tbody>
          <tfoot>
            <tr>
              <th scope="row">Total</th>
              <td>{{ time_for_user_and_date|format_minutes }}</td>
            </tr>
          </tfoot>
        </table>
        {% else %}
      <h2>No entries today.</h2>
        {% endif %}

      <a href="?num_days={{ num_days|add:'1' }}">Previous</a>
      {% if num_days > 0 %}
      <a href="?num_days={{ num_days|add:'-1' }}">Next</a>
      {% endif %}
    </div>
    <div class="col">
            <h2>Your time {% if user_num_months is 0 %}this month{% else %}{{ user_month|date:"Y-m" }}{% endif %}</h2>
      {% if time_for_user_and_month %}
        <table class="table">
          <thead>
          <tr>
            <th scope="row">Project</th>
            <th scope="row">Time</th>
          </tr>
          </thead>
          <tbody>
          {% for project in all_projects %}
          {% if project.time_for_user_and_project_and_month > 0 %}
                    <tr>
            <td>{{ project.title }}</td>
            <td>{{ project.time_for_user_and_project_and_month|format_minutes }}</td>
          </tr>
          {% endif %}
          {% endfor %}
          </tbody>
          <tfoot>
            <tr>
              <th scope="row">Total</th>
              <td>{{ time_for_user_and_month|format_minutes }}</td>
            </tr>
          </tfoot>
        </table>
        {% else %}
      <h2>No entries this month.</h2>
        {% endif %}

      <a href="?user_num_months={{ user_num_months|add:'1' }}">Previous</a>
      {% if user_num_months > 0 %}
      <a href="?user_num_months={{ user_num_months|add:'-1' }}">Next</a>
      {% endif %}
    </div>
    <div class="w-100"></div>
   {% if request.user == team.created_by %}
    <div class="col">
      <h2>Your team {% if team_num_months is 0 %}this month{% else %}{{ team_month|date:"Y-m" }}{% endif %}</h2>
      {% if time_for_team_and_month > 0 %}
        <table class="table">
          <thead>
          <tr>
            <th scope="row">Name</th>
            <th scope="row">Time</th>
          </tr>
          </thead>
          <tbody>
          {% for member in members %}

                    <tr>
            <td>{% firstof member.get_full_name member.username %}</td>
            <td>{{ member.time_for_user_and_team_month|format_minutes }}</td>
          </tr>
          {% endfor %}


          </tbody>

        </table>
        {% else %}
      <h2>No registered time for this team this month.</h2>
        {% endif %}
            <a href="?team_num_months={{ team_num_months|add:'1' }}">Previous</a>
      {% if team_num_months > 0 %}
      <a href="?team_num_months={{ team_num_months|add:'-1' }}">Next</a>
    </div>
    {% endif %}
    {% endif %}
    <div class="col">col</div>
  </div>
</div>
{% endblock %}