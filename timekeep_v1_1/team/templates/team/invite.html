{% extends 'base.html' %}

{% block title %}{{ team.title }} | {% endblock %}

{% block content %}

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="{% url 'account' %}">My account</a></li>
            <li class="breadcrumb-item"><a href="{% url 'team:team' team.id %}">{{ team.title }}</a></li>
            <li class="breadcrumb-item active" aria-current="page"><a href="{% url 'team:invite' %}">Invite Member</a></li>
        </ol>
    </nav>

    <div class="row">
       <div class="columns is-multiline" id="invite-app">
            <h1>Invite Member</h1>
            <div class="notification is-danger" v-if="errors.length">
                <p v-for="error in errors">[[ error ]]</p>
            </div>

            <form method="post" action="." @submit="validateForm" novalite>
                    {% csrf_token %}

                    <div class="field">
                        <label>E-mail</label>

                        <div class="control">
                            <input type="email" name="email" id="id_email" v-model="email" class="input">
                        </div>
                    </div>

                    <div class="field">
                        <div class="control">
                            <button class="button is-success">Send invitation</button>
                        </div>
                    </div>
            </form>
       </div>
    </div>
{% endblock %}

{% block scripts %}
<script>
    const InviteApp = {
        data() {
            return {
                email: '',
                errors: []
            }
        },
        delimiters: ['[[', ']]'],
        methods: {
            validateForm(e) {
                if (this.validateEmail(this.email)) {
                    return true
                }

                this.errors = ['The e-mail is not valid']

                e.preventDefault()

                return false
            },
            validateEmail(email) {
                if (/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(email)) {
                    return true
                }

                return false
            }
        }
    }

    Vue.createApp(InviteApp).mount('#invite-app')
</script>
{% endblock %}